<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>N√∫t OK v·ª° v·ª•n</title>
<style>
  :root{ --w:560px; --h:340px; }
  body{ font-family:system-ui,sans-serif; display:grid; place-items:center; min-height:100vh; background:#f6f7fb; }
  .wrap{ text-align:center; }
  .box{
    position:relative; width:var(--w); height:var(--h);
    border:2px dashed #cdd3df; background:#fff; border-radius:16px;
    box-shadow:0 6px 24px rgba(16,24,40,.06); overflow:hidden; margin-top:14px;
  }
  .row{ position:absolute; inset:18px 18px auto 18px; display:flex; gap:10px; justify-content:center; }
  button{
    padding:10px 18px; border:none; border-radius:10px; font-size:16px; cursor:pointer;
    color:#fff; font-weight:600; box-shadow:0 2px 10px rgba(16,24,40,.08);
  }
  #okBtn{ background:#16a34a; }
  #cancelBtn{ background:#ef4444; }
  #resetBtn{ background:#475467; }
  /* m·∫£nh v·ª° */
  .piece{
    position:absolute; border-radius:3px; pointer-events:none; will-change:transform, opacity;
    transform: translate(0,0) rotate(0deg) scale(1);
    opacity:1;
  }
  @keyframes explode {
    to {
      transform: translate(var(--dx), var(--dy)) rotate(var(--rot)) scale(0.9);
      opacity: 0;
    }
  }
</style>
</head>
<body>
  <div class="wrap">
    <h2>B·∫•m ‚ÄúOK‚Äù ƒë·ªÉ xem n√≥ v·ª° v·ª•n üí•</h2>
    <div class="box" id="box">
      <div class="row">
        <button id="okBtn">OK</button>
        <button id="cancelBtn">H·ª¶Y</button>
        <button id="resetBtn" hidden>L√ÄM L·∫†I</button>
      </div>
    </div>
  </div>

<script>
(() => {
  const box = document.getElementById('box');
  const ok  = document.getElementById('okBtn');
  const cancel = document.getElementById('cancelBtn');
  const reset = document.getElementById('resetBtn');

  // c·∫•u h√¨nh ‚Äúv·ª° v·ª•n‚Äù
  const PIECE = 10;      // k√≠ch th∆∞·ªõc m·ªói m·∫£nh (px)
  const SPREAD = 220;    // ƒë·ªô vƒÉng t·ªëi ƒëa theo ph∆∞∆°ng ngang/d·ªçc (px)
  const DUR_MIN = 600;   // th·ªùi l∆∞·ª£ng n·ªï t·ªëi thi·ªÉu (ms)
  const DUR_MAX = 1100;  // th·ªùi l∆∞·ª£ng n·ªï t·ªëi ƒëa (ms)

  ok.addEventListener('click', (e) => {
    e.preventDefault();
    shatter(ok);
  });

  reset.addEventListener('click', () => {
    // x√≥a m·∫£nh c≈© v√† hi·ªán l·∫°i n√∫t
    box.querySelectorAll('.piece').forEach(p => p.remove());
    ok.hidden = false;
    cancel.hidden = false;
    reset.hidden = true;
  });

  function shatter(btn){
    const boxRect = box.getBoundingClientRect();
    const r = btn.getBoundingClientRect();

    // 1) ·∫®n n√∫t g·ªëc
    btn.hidden = true;
    cancel.hidden = true;

    // 2) L·∫•y m√†u n·ªÅn + vi·ªÅn kh·ªõp v·ªõi n√∫t
    const cs = getComputedStyle(btn);
    const bg = cs.backgroundColor;

    // 3) T·∫°o l∆∞·ªõi m·∫£nh bao ph·ªß to√†n b·ªô n√∫t
    const width = r.width, height = r.height;
    const cols = Math.max(1, Math.floor(width / PIECE));
    const rows = Math.max(1, Math.floor(height / PIECE));
    const pieceW = width / cols;
    const pieceH = height / rows;

    // 4) V·ªã tr√≠ g·ªëc t∆∞∆°ng ƒë·ªëi v·ªõi box
    const originLeft = r.left - boxRect.left;
    const originTop  = r.top  - boxRect.top;

    // 5) T·∫°o m·∫£nh + ho·∫°t ·∫£nh
    const frag = document.createDocumentFragment();

    for(let y=0; y<rows; y++){
      for(let x=0; x<cols; x++){
        const px = document.createElement('div');
        px.className = 'piece';
        px.style.width = `${pieceW + 0.5}px`;
        px.style.height = `${pieceH + 0.5}px`;
        px.style.left = `${originLeft + x*pieceW}px`;
        px.style.top  = `${originTop + y*pieceH}px`;
        px.style.background = bg;
        px.style.boxShadow = '0 1px 3px rgba(16,24,40,.12)';

        // m·ªói m·∫£nh bay ng·∫´u nhi√™n, h∆°i c√≥ l·ª±c ‚Äún·ªï‚Äù t·ª´ t√¢m
        const cx = (x + 0.5) / cols - 0.5; // -0.5..0.5
        const cy = (y + 0.5) / rows - 0.5;
        const bias = Math.hypot(cx, cy); // m·∫£nh g·∫ßn r√¨a bay xa h∆°n ch√∫t

        const randX = (Math.random()*2 - 1) * SPREAD * (0.6 + bias*0.8);
        const randY = (Math.random()*1.2 - 0.2) * SPREAD * (0.6 + bias*0.8); // ∆∞u ti√™n bay xu·ªëng
        const rot = (Math.random()*720 - 360) + 'deg';
        const dur = (DUR_MIN + Math.random()*(DUR_MAX - DUR_MIN)) + 'ms';

        px.style.setProperty('--dx', `${randX}px`);
        px.style.setProperty('--dy', `${randY}px`);
        px.style.setProperty('--rot', rot);
        px.style.animation = `explode ${dur} cubic-bezier(.15,.6,.25,1) forwards`;

        frag.appendChild(px);
      }
    }

    box.appendChild(frag);

    // 6) Sau khi n·ªï xong, hi·ªán n√∫t ‚ÄúL√ÄM L·∫†I‚Äù
    const maxDur = DUR_MAX + 80;
    setTimeout(() => {
      reset.hidden = false;
    }, maxDur);
  }
})();
</script>
</body>
</html>
